@model FridgeManagementSystem.Models.ReportDashboardViewModel

@{
    ViewData["Title"] = "Reports Dashboard";
    Layout = "_Layout";
}

<style>
    /* ===== MINIMIZED PROFESSIONAL STYLING ===== */

    /* Remove excessive spacing and reduce sizes */
    .container-fluid {
        padding: 10px 15px;
        background: #f8f9fa;
    }

    /* Compact header */
    .header-section {
        margin-bottom: 15px;
    }

        .header-section h1 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

    /* Compact button */
    .btn-compact {
        padding: 6px 12px;
        font-size: 0.85rem;
        border-radius: 4px;
    }

    /* Smaller cards */
    .card {
        margin-bottom: 15px;
        border: 1px solid #dee2e6;
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .card-header {
        padding: 10px 15px;
        font-size: 0.95rem;
        font-weight: 600;
    }

    .card-body {
        padding: 15px;
    }

    /* Compact summary cards */
    .summary-card {
        padding: 12px;
        margin-bottom: 10px;
        border-radius: 5px;
    }

        .summary-card .card-title {
            font-size: 0.8rem;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .summary-card h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 3px;
        }

        .summary-card small {
            font-size: 0.75rem;
            opacity: 0.8;
        }

    /* Smaller charts */
    .chart-container {
        height: 200px;
        margin: 10px 0;
    }

    /* Compact tables */
    .table-sm {
        font-size: 0.85rem;
    }

        .table-sm th,
        .table-sm td {
            padding: 8px 10px;
        }

    /* Reduced spacing */
    .row {
        margin-bottom: 10px;
    }

    .mb-2 {
        margin-bottom: 8px !important;
    }

    .mb-3 {
        margin-bottom: 12px !important;
    }

    .mt-2 {
        margin-top: 8px !important;
    }

    /* Smaller section spacing */
    section {
        margin-bottom: 20px;
    }

    /* Compact form elements */
    .form-label {
        font-size: 0.9rem;
        margin-bottom: 5px;
        font-weight: 500;
    }

    /* Professional color scheme */
    .bg-primary {
        background: linear-gradient(135deg, #3498db, #2980b9) !important;
    }

    .bg-success {
        background: linear-gradient(135deg, #27ae60, #219653) !important;
    }

    .bg-warning {
        background: linear-gradient(135deg, #f39c12, #e67e22) !important;
    }

    .bg-info {
        background: linear-gradient(135deg, #17a2b8, #138496) !important;
    }

    .bg-danger {
        background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
    }

    /* Icon sizing */
    .fas, .fab {
        font-size: 0.9rem;
        margin-right: 5px;
    }

    /* Responsive adjustments */
    @@media (max-width: 768px) {
        .container-fluid

    {
        padding: 8px 10px;
    }

    .summary-card {
        margin-bottom: 8px;
    }

    .chart-container {
        height: 150px;
    }

    }
</style>

<div class="container-fluid">
    <!-- Compact Header Section -->
    <div class="header-section">
        <div class="d-flex justify-content-between align-items-center">
            <a href="https://localhost:7130/Administrator/ManageEmployee/Dashboard" class="btn btn-secondary btn-compact">
                <i class="fas fa-arrow-left"></i>Back to Dashboard
            </a>
            <h1 class="mb-0">Reports Dashboard</h1>
        </div>
    </div>

    <!-- Maintenance Performance - Compact -->
    <div class="card mb-3">
        <div class="card-header bg-info text-white">
            <i class="fas fa-chart-bar"></i>Maintenance Performance - This Month
        </div>
        <div class="card-body">
            <canvas id="maintenanceChart" height="120"></canvas>
        </div>
    </div>

    <!-- Customer Management Reports - Compact -->
    <section class="mb-4">
        <div class="card">
            <div class="card-header bg-success text-white">
                <i class="fas fa-users"></i>Customer Management Reports
            </div>
            <div class="card-body">
                <!-- Compact Summary Cards -->
                <div class="row mb-3">
                    <div class="col-md-3">
                        <div class="card text-white bg-primary summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">Total Customers</h6>
                                <h2 id="totalCustomers" class="mb-1">0</h2>
                                <small>Active & Inactive</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-white bg-success summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">Active Customers</h6>
                                <h2 id="activeCustomers" class="mb-1">0</h2>
                                <small>With Allocations</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-white bg-warning summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">Total Allocated</h6>
                                <h2 id="totalAllocated" class="mb-1">0</h2>
                                <small>Currently Active</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-white bg-info summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">Available Fridges</h6>
                                <h2 id="availableFridges" class="mb-1">0</h2>
                                <small>In Stock</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compact Charts Row -->
                <div class="row mb-3">
                    <div class="col-md-8">
                        <div class="card h-100">
                            <div class="card-header py-2">
                                <h6 class="card-title mb-0">Customer Distribution by Location</h6>
                            </div>
                            <div class="card-body p-2">
                                <canvas id="locationDistributionChart" height="150"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-header py-2">
                                <h6 class="card-title mb-0">Customer Status</h6>
                            </div>
                            <div class="card-body p-2">
                                <canvas id="customerStatusChart" height="150"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compact Table -->
                <div class="row mb-3">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header py-2">
                                <h6 class="card-title mb-0">Fridge Allocation Summary</h6>
                            </div>
                            <div class="card-body p-2">
                                <div class="table-responsive">
                                    <table class="table table-sm table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Status</th>
                                                <th class="text-end">Count</th>
                                                <th class="text-end">Percentage</th>
                                            </tr>
                                        </thead>
                                        <tbody id="fridgeAllocationSummary">
                                            <tr><td colspan="3" class="text-center">Loading data...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compact Trends Chart -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header py-2">
                                <h6 class="card-title mb-0">Allocation Trends (Last 6 Months)</h6>
                            </div>
                            <div class="card-body p-2">
                                <canvas id="allocationTrendsChart" height="80"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Fault Management Reports - Compact -->
    <section class="mb-4">
        <div class="card">
            <div class="card-header bg-danger text-white">
                <i class="fas fa-exclamation-triangle"></i>Fault Management Reports
            </div>
            <div class="card-body">
                <!-- Compact Fault Summary Cards -->
                <div class="row mb-3">
                    <div class="col-md-3">
                        <div class="card text-white bg-danger summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">Total Faults</h6>
                                <h2 id="totalFaults" class="mb-1">0</h2>
                                <small>All Time</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-white bg-warning summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">Pending Faults</h6>
                                <h2 id="pendingFaults" class="mb-1">0</h2>
                                <small>Awaiting Action</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-white bg-primary summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">High Priority</h6>
                                <h2 id="highPriorityFaults" class="mb-1">0</h2>
                                <small>Urgent Cases</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-white bg-success summary-card">
                            <div class="card-body text-center p-2">
                                <h6 class="card-title">Avg Resolution</h6>
                                <h2 id="avgResolutionDays" class="mb-1">0</h2>
                                <small>Days</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compact Fault Charts -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header py-2">
                                <h6 class="card-title mb-0">Fault Type Distribution</h6>
                            </div>
                            <div class="card-body p-2">
                                <canvas id="faultTypeChart" height="150"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header py-2">
                                <h6 class="card-title mb-0">Urgency Level Distribution</h6>
                            </div>
                            <div class="card-body p-2">
                                <canvas id="faultUrgencyChart" height="150"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compact Action Card -->
                <div class="row mt-3">
                    <div class="col-12">
                        <div class="card bg-light">
                            <div class="card-body text-center py-3">
                                <h6 class="card-title mb-2">Need More Detailed Fault Analysis?</h6>
                                <p class="card-text mb-2 small">Access comprehensive fault analytics with detailed breakdowns.</p>
                                <a href="@Url.Action("FaultReports", "Reports")" class="btn btn-danger btn-sm">
                                    <i class="fas fa-chart-bar"></i>View Detailed Reports
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
       

        var ctx = document.getElementById('maintenanceChart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Completed Tasks', 'Avg Days to Complete', 'Success Rate %', 'Repeat Visits'],
                datasets: [{
                    label: 'Maintenance KPI',
                    data: [
                        @Model.MaintenanceKpi.CompletedThisMonth,
                        @Model.MaintenanceKpi.AvgCompletionDays.ToString("0"),
                        @Model.MaintenanceKpi.SuccessRate.ToString("0"),
                        @Model.MaintenanceKpi.MonthlyRepeatVisits
                    ],
                    backgroundColor: ['#3498db', '#2ecc71', '#f1c40f', '#e74c3c']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });

       
    </script>
}